!function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){!function(){if("undefined"==typeof AFRAME)return void console.error("Component attempted to register before AFRAME was available.");var t={example:o(1).component};Object.keys(t).forEach(function(e){AFRAME.aframeCore?AFRAME.aframeCore.registerComponent(e,t[e]):AFRAME.registerComponent(e,t[e])})}()},function(t,e){var o=Math.PI/2;t.exports.component={dependencies:["position","rotation"],schema:{enabled:{"default":!0},sensitivity:{"default":1}},init:function(){this.sceneEl=document.querySelector("a-scene"),this.canvasEl=this.sceneEl.canvas,this.setupMouseControls(),this.setupHMDControls(),this.attachEventListeners(),this.bindFunctions(),this.sceneEl.addBehavior(this),this.previousPosition=new THREE.Vector3,this.deltaPosition=new THREE.Vector3},setupMouseControls:function(){this.pitchObject=new THREE.Object3D,this.yawObject=new THREE.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject),this.lockIsSupported="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document},setupHMDControls:function(){this.dolly=new THREE.Object3D,this.euler=new THREE.Euler,this.controls=new THREE.VRControls(this.dolly),this.zeroQuaternion=new THREE.Quaternion},attachEventListeners:function(){this.lockIsSupported&&(document.addEventListener("pointerlockchange",this.onLockChange.bind(this),!1),document.addEventListener("mozpointerlockchange",this.onLockChange.bind(this),!1),document.addEventListener("webkitpointerlockchange",this.onLockChange.bind(this),!1),document.addEventListener("pointerlockerror",this.onLockError,!1),document.addEventListener("mozpointerlockerror",this.onLockError,!1),document.addEventListener("webkitpointerlockerror",this.onLockError,!1),this.canvasEl.onclick=this.captureMouse.bind(this))},bindFunctions:function(){this.onMouseMoveL=this.onMouseMove.bind(this)},remove:function(){this.releaseMouse(),this.sceneEl.removeBehavior(this)},captureMouse:function(){this.sceneEl.requestPointerLock=this.sceneEl.canvas.requestPointerLock||this.sceneEl.canvas.mozRequestPointerLock||this.sceneEl.canvas.webkitRequestPointerLock,this.sceneEl.requestPointerLock()},releaseMouse:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock()},onLockChange:function(t){var e=this.el.sceneEl;document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e?document.addEventListener("mousemove",this.onMouseMoveL,!1):(console.log("pointer unlock"),document.removeEventListener("mousemove",this.onMouseMoveL,!1))},onLockError:function(t){console.trace(t)},update:function(){this.data.enabled&&(this.controls.update(),this.updateOrientation(),this.updatePosition())},updateOrientation:function(){var t=new THREE.Euler;return t.order="YXZ",function(){var e=this.pitchObject,o=this.yawObject,n=this.calculateHMDQuaternion();t.setFromQuaternion(n),this.el.setAttribute("rotation",{x:THREE.Math.radToDeg(t.x)+THREE.Math.radToDeg(e.rotation.x),y:THREE.Math.radToDeg(t.y)+THREE.Math.radToDeg(o.rotation.y),z:THREE.Math.radToDeg(t.z)})}}(),calculateHMDQuaternion:function(){var t=new THREE.Quaternion;return function(){var e=this.dolly;return this.zeroed||e.quaternion.equals(this.zeroQuaternion)||(this.zeroOrientation(),this.zeroed=!0),t.copy(this.zeroQuaternion).multiply(e.quaternion),t}}(),updatePosition:function(){var t=new THREE.Vector3,e=new THREE.Quaternion,o=new THREE.Vector3;return function(){var n=this.el,i=this.calculateDeltaPosition(),r=n.getComputedAttribute("position");this.el.object3D.matrixWorld.decompose(t,e,o),i.applyQuaternion(e),n.setAttribute("position",{x:r.x+i.x,y:r.y+i.y,z:r.z+i.z})}}(),calculateDeltaPosition:function(){var t=this.dolly,e=this.deltaPosition,o=this.previousPosition;return e.copy(t.position),e.sub(o),o.copy(t.position),e},updateHMDQuaternion:function(){var t=new THREE.Quaternion;return function(){var e=this.dolly;return this.controls.update(),this.zeroed||e.quaternion.equals(this.zeroQuaternion)||(this.zeroOrientation(),this.zeroed=!0),t.copy(this.zeroQuaternion).multiply(e.quaternion),t}}(),zeroOrientation:function(){var t=new THREE.Euler;t.setFromQuaternion(this.dolly.quaternion.clone().inverse()),t.z=0,t.x=0,this.zeroQuaternion.setFromEuler(t)},onMouseMove:function(t){if(this.data.enabled){var e=t.movementX||t.mozMovementX||t.webkitMovementX||0,n=t.movementY||t.mozMovementY||t.webkitMovementY||0;this.yawObject.rotation.y-=.002*e*this.data.sensitivity,this.pitchObject.rotation.x-=.002*n*this.data.sensitivity,this.pitchObject.rotation.x=Math.max(-o,Math.min(o,this.pitchObject.rotation.x))}}}}]);